@extends('layouts.commonMaster')
@section('layoutContent')
@section('title', 'All customers |')

<style>
    @charset "UTF-8";
    .bootstrap-tagsinput {
        margin: 0;
        width: 100%;
        padding: 0.5rem 0.75rem 0;
        font-size: 1rem;
        line-height: 1.25;
        transition: border-color 0.15s ease-in-out;
    }
    .bootstrap-tagsinput.has-focus {
        background-color: #681320;
        border-color: #5cb3fd;
    }
    .bootstrap-tagsinput .label-info {
        display: inline-block;
        background-color: #681320;
        padding: 0 0.4em 0.15em;
        border-radius: 0.25rem;
        margin-bottom: 0.4em;
    }
    .bootstrap-tagsinput input {
        margin-bottom: 0.5em;
    }

    .bootstrap-tagsinput .tag [data-role=remove]:after {
        content: "Ã—";
        padding: 1px 2px;
    }
    .addalert{
        border: 1px solid red !important;
    }
    .color-show{
        display: inline-block;
        width: 15px;
        height: 15px;
        border-radius: 3px;
        border: 1px solid #000000;
        margin-right: 5px;
    }
    .image-content{
        display: flex;
        width: 150px;
        height: 100px;
        border: 1px solid #bdc6d2;
        border-radius: 10px;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        background: #e1e5ec;
        position: relative;
    }
    .image-content img{
        position: absolute;
        width: 100%;
        height: 100%;
    }
    .image-content span{
        position: absolute;
        z-index: 99999;
        right: -10px;
        top: -10px;
        border-radius: 50%;
        background: red;
        color: #fff;
        width: 25px;
        height: 25px;
        padding: 0px 1px 0px 5px;
        cursor:pointer;
    }
    .image-content span i{
        font-size: 15px;
    }
    .image-content label{
        width: 100%!important;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    .image-content label i{
        font-weight: 1000;
        font-size: 20px;
    }
    .bootstrap-tagsinput{
        border: 1px solid #b8b3b3;
        border-radius: 5px;
    }
    .bootstrap-tagsinput input{
        border: none;
        outline: none;
    } 
    .bootstrap-tagsinput .label-info {
        color:#fff
    }
</style>
<!-- Content wrapper -->
<div class="content-wrapper">

    <!-- Content -->
    <div class="container-xxl flex-grow-1 container-p-y">

        <h4 class="py-3 mb-4">
            <span class="text-muted fw-light">Products /</span><span> Add Product</span>
        </h4>

        <div class="app-ecommerce">

            <div class="row">

                <!-- First column-->
                <div class="col-12 col-lg-12">
                    <!-- Product Information -->
                    <div class="col-xl-12">

                        <div class="nav-align-top   mb-4">
                            <ul class="nav nav-tabs nav-fill" role="tablist">
                                <li class="nav-item">
                                    <button
                                        type="button"
                                        class="nav-link d-flex justify-content-between active"
                                        role="tab"
                                        data-bs-toggle="tab"
                                        data-bs-target="#navs-justified-home"
                                        aria-controls="navs-justified-home"
                                        aria-selected="true"
                                        >
                                        <div class="col-md-10"> <i class="tf-icons bx bx-receipt"></i> Basic Details</div>
                                        <div class="col-md-2">
                                            <span class="badge rounded-pill d-none  basic_detail_alert badge-center ml-3 h-px-20 w-px-20 bg-label-danger">
                                                <i style="font-weight: 600;" class='bx bx-x'></i>
                                            </span>
                                            <span class="badge rounded-pill {{isset($product) && $product->step1 == 1  ?"d-none":""}} basic_detail_alert badge-center ml-3 h-px-20 w-px-20 bg-label-success">
                                                <i style="font-weight: 600;" class='bx bx-check'></i>
                                            </span>
                                        </div>                                                            
                                    </button> 
                                </li>
                                <li class="nav-item">
                                    <button
                                        type="button"
                                        class="nav-link"
                                        role="tab"
                                        data-bs-toggle="tab"
                                        data-bs-target="#navs-justified-profile"
                                        aria-controls="navs-justified-profile"
                                        aria-selected="false" {{isset($product) && $product->step1 ==1  ?"":"disabled"}} 
                                        >
                                        <div class="col-md-10"> <i class="tf-icons bx bx-purchase-tag"></i> Price Details</div>
                                        <div class="col-md-2">
                                            <span class="badge rounded-pill {{(!isset($product)?'d-none':(($product->step2 == 1)?"d-none":""))}} price_detail_alert badge-center ml-3 h-px-20 w-px-20 bg-label-danger">
                                                <i style="font-weight: 600;" class='bx bx-x'></i>
                                            </span>
                                            <span class="badge rounded-pill {{(!isset($product)?'d-none':(($product->step2 != 1)?"d-none":""))}} price_detail_alert badge-center ml-3 h-px-20 w-px-20 bg-label-success">
                                                <i style="font-weight: 600;" class='bx bx-check'></i>
                                            </span>
                                        </div>                                  

                                    </button>
                                </li>
                                <li class="nav-item">
                                    <button
                                        type="button"
                                        class="nav-link d-flex justify-content-between"
                                        role="tab"
                                        data-bs-toggle="tab"
                                        data-bs-target="#navs-justified-messages"
                                        aria-controls="navs-justified-messages"
                                        aria-selected="false"  {{ isset($product) && $product->step2 == 1  ?"":"disabled"}}
                                        >

                                        <div class="col-md-10"> <i class="tf-icons bx bx-code-alt"></i> Unit List</div>
                                        <div class="col-md-2">
                                            <span class="badge rounded-pill {{(!isset($product)?'d-none':(($product->step3 == 1)?"d-none":""))}} unit_detail_alert badge-center ml-3 h-px-20 w-px-20 bg-label-danger">
                                                <i style="font-weight: 600;" class='bx bx-x'></i>
                                            </span>
                                            <span class="badge rounded-pill {{(!isset($product)?'d-none':(($product->step3 != 1)?"d-none":""))}} unit_detail_alert badge-center ml-3 h-px-20 w-px-20 bg-label-success">
                                                <i style="font-weight: 600;" class='bx bx-check'></i>
                                            </span>
                                        </div>  

                                    </button>
                                </li>
                                <li class="nav-item"> 
                                    <button
                                        type="button"
                                        class="nav-link d-flex justify-content-between"
                                        role="tab"
                                        data-bs-toggle="tab"
                                        data-bs-target="#navs-justified-image"
                                        aria-controls="navs-justified-image"
                                        aria-selected="false" {{isset($product) && $product->step3 ==1 ?"":"disabled"}}

                                        >

                                        <div class="col-md-10"> <i class="tf-icons bx bx-image-add"></i> Images Details</div>
                                        <div class="col-md-2">
                                            <span class="badge rounded-pill {{(!isset($product)?'d-none':(($product->step4 == 1)?"d-none":""))}} image_detail_alert badge-center ml-3 h-px-20 w-px-20 bg-label-danger">
                                                <i style="font-weight: 600;" class='bx bx-x'></i>
                                            </span>
                                            <span class="badge rounded-pill {{(!isset($product)?'d-none':(($product->step4 != 1)?"d-none":""))}} image_detail_alert badge-center ml-3 h-px-20 w-px-20 bg-label-success">
                                                <i style="font-weight: 600;" class='bx bx-check'></i>
                                            </span>
                                        </div>  

                                    </button>
                                </li>
                                <li class="nav-item"> 
                                    <button
                                        type="button"
                                        class="nav-link d-flex justify-content-between"
                                        role="tab"
                                        data-bs-toggle="tab"
                                        data-bs-target="#navs-justified-keypoint"
                                        aria-controls="navs-justified-keypoint"
                                        aria-selected="false"  {{isset($product) && $product->step3 ==1  ?"":"disabled"}}
                                        >
                                        <div class="col-md-10"> <i class="tf-icons bx bx-key"></i> Key Words</div>
                                        <div class="col-md-2">
                                            <span class="badge rounded-pill {{(!isset($product)?'d-none':(($product->step5 != 1)?"d-none":""))}} key_detail_alert badge-center ml-3 h-px-20 w-px-20 bg-label-danger">
                                                <i style="font-weight: 600;" class='bx bx-x'></i>
                                            </span>
                                            <span class="badge rounded-pill {{(!isset($product)?'d-none':(($product->step5 != 1)?"d-none":""))}} key_detail_alert badge-center ml-3 h-px-20 w-px-20 bg-label-success">
                                                <i style="font-weight: 600;" class='bx bx-check'></i>
                                            </span>
                                        </div>  

                                    </button> 
                                </li>
                            </ul>
                            <div class="tab-content  ">

                                <div class="tab-pane fade show active" id="navs-justified-home" role="tabpanel">
                                    <input id="project_id" value="{{(isset($_GET["pid"]))?$_GET["pid"]:0}}" type="hidden">
                                    <input id="category_id" value="{{(isset($_GET["cid"]))?$_GET["cid"]:0}}" type="hidden">
                                    <form id="basic_form" class="needs-validation" novalidate onsubmit="return false">
                                        @csrf
                                        <div class="mb-3">
                                            <label class="form-label" for="ecommerce-product-name">Name</label>
                                            <input type="text" class="form-control" id="ecommerce-product-name"

                                                   placeholder="Product title" value="{{isset($product) && $product->product_name != null ?$product->product_name :""}}" name="name" aria-label="Product title" required>
                                        </div>

                                        <!-- Description -->
                                        <div>
                                            <label class="form-label">Description</label>

                                            <textarea class="form-control" id="description" name="description" required>{{isset($product) && $product->description != null ?$product->description :""}}</textarea>

                                        </div>
                                        <div class="row mb-3 mt-3 align-items-center">
                                            <div class="col-6"><label class="form-label" for="height">Height
                                                    <span class="text-muted">(Optional)</span></label>
                                                <input type="number" class="form-control" value="{{isset($product) && $product->height != null ?$product->height :""}}" id="height" placeholder="Enter Height"
                                                       name="height" aria-label="Height"   >

                                            </div>
                                            <div class="col-6 mt-4">
                                                <select class="select2 form-control" name="height_unit">
                                                    <option value="">Select Unit</option>
                                                    <option value="mm" {{isset($product) && $product->height_unit == "mm" ?"selected='selected'":""}} >mm</option>
                                                    <option value="cm" {{isset($product) && $product->height_unit == "cm" ?"selected='selected'":""}}  >cm</option>
                                                    <option value="in" {{isset($product) && $product->height_unit == "in" ?"selected='selected'":""}}  >in</option>
                                                    <option value="m" {{isset($product) && $product->height_unit == "m" ?"selected='selected'":""}}  >m</option>
                                                </select>
                                            </div>
                                            <div class="col-6"><label class="form-label" for="width">Width
                                                    <span class="text-muted">(Optional)</span></label>
                                                <input type="text" class="form-control"  value="{{isset($product) && $product->width != null ?$product->width :""}}" id="width" placeholder="Enter width"
                                                       name="width" aria-label="Width"
                                                       >
                                            </div>
                                            <div class="col-6 mt-4">
                                                <select class="select2 form-control"  name="width_unit">
                                                    <option value="">Select Unit</option>
                                                    <option value="mm" {{isset($product) && $product->width_unit == "mm" ?"selected='selected'":""}} >mm</option>
                                                    <option value="cm" {{isset($product) && $product->width_unit == "cm" ?"selected='selected'":""}}  >cm</option>
                                                    <option value="in" {{isset($product) && $product->width_unit == "in" ?"selected='selected'":""}}  >in</option>
                                                    <option value="m" {{isset($product) && $product->width_unit == "m" ?"selected='selected'":""}}  >m</option>

                                                </select>
                                            </div>
                                            <div class="col-6"><label class="form-label" for="Weight">Weight
                                                    <span class="text-muted">(Optional)</span></label>
                                                <input type="text" class="form-control" value="{{isset($product) && $product->weight != null ?$product->weight :""}}" id="weight" placeholder="Enter Weight"
                                                       name="weight" aria-label="Weight"
                                                       >
                                            </div>
                                            <div class="col-6 mt-4">
                                                <select class="select2 form-control" name="weight_unit">
                                                    <option value="" {{isset($product) && $product->weight_unit == "" ?"selected='selected'":""}} >Select Unit</option>
                                                    <option value="g" {{isset($product) && $product->weight_unit == "g" ?"selected='selected'":""}} >g</option>
                                                    <option value="kg" {{isset($product) && $product->weight_unit == "kg" ?"selected='selected'":""}} >kg</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="text-end" ><button type="submit" class="btn btn-success">Save</button></div>
                                    </form>
                                </div>
                                <div class="tab-pane fade" id="navs-justified-profile" role="tabpanel">
                                    <form id="price_form" class="needs-validation" novalidate onsubmit="return false">
                                        @csrf
                                        <div class="mb-3">
                                            <label class="form-label" for="product-price">Base Price</label>
                                            <input type="number" class="form-control" id="product-price" placeholder="Price"
                                                   value="{{isset($product) && $product->web_price != null ?$product->web_price :""}}" aria-label="Product price" required=""
                                                   >
                                        </div>
                                        <!-- Discounted Price -->
                                        <div class="mb-3">
                                            <label class="form-label" for="discount-price">Discounted
                                                Price</label>
                                            <input type="number" class="form-control" id="discount-price"
                                                   placeholder="Discounted Price" name="discount_price"
                                                   aria-label="Product discounted price"
                                                   value="{{isset($product) && $product->web_discount_price != null ?$product->web_discount_price :""}}" required="">
                                        </div>


                                        <!-- In stock -->
                                        <div class="mb-3 col ecommerce-select2-dropdown">
                                            <label class="form-label mb-1" for="status-org">In Stock
                                            </label>
                                            <select id="stock" class="select2 form-select" data-placeholder="Select Status"
                                                    name="in_stock" required="">
                                                <option value="">Select</option>
                                                <option value="0" {{isset($product) && $product->web_status == 0 ?"selected='selected'":""}} >Available</option>
                                                <option value="1" {{isset($product) && $product->web_status == 1 ?"selected='selected'":""}} >Not Available</option>
                                            </select>
                                        </div>
                                        
                                        <div class="mb-3 col ecommerce-select2-dropdown">
                                    <label class="form-label mb-1" for="collection">Collection
                                    </label>
                                    <select id="collection" class="select2 form-select" data-placeholder="Collection"
                                        name="collection">
                                        <option selected value="0" {{isset($product) && $product->collection == 0 ?"selected='selected'":""}} >None</option>
                                        <option value="1" {{isset($product) && $product->collection == 1 ?"selected='selected'":""}} >Trending  collections</option>
                                    </select>
                                  </div>
                                        <div class="text-end" ><button type="submit" class="btn btn-success">Save</button></div>
                                    </form>
                                </div>
                                <div class="tab-pane fade" id="navs-justified-messages" role="tabpanel">
                                    <form id="unit_form" class="needs-validation" novalidate onsubmit="return false">
                                        @csrf
                                        <div class="row d-flex justify-content-center badge bg-label-secondary">
                                            <div class="col-md-2">
                                                <label class="form-label" for="basic-default-fullname">Size</label>
                                                <select id="product_size" class="select2 form-select" data-placeholder="Select Size"
                                                        name="product_size" required="">
                                                    <option value="">Select</option>
                                                    @foreach($UnitSize as $_size)
                                                    <option value="{{$_size->m_size_id}}" >{{$_size->size_name}}</option>
                                                    @endforeach
                                                </select>
                                            </div>
                                            <div class="col-md-2">
                                                <label class="form-label" for="basic-default-fullname">Material</label>
                                                <select id="product_material" class="select2 form-select" data-placeholder="Select Material"
                                                        name="product_material" required="">
                                                    <option value="">Select</option>
                                                    @foreach($UnitMatrial as $_matriale)
                                                    <option value="{{$_matriale->m_material_id}}" >{{$_matriale->material_name}}</option>
                                                    @endforeach
                                                </select>
                                            </div>
                                            <div class="col-md-2">
                                                <label class="form-label" for="basic-default-fullname">Color</label>
                                                <select id="product_color" class="select2 form-select" data-placeholder="Select Color"
                                                        name="product_color" required="">
                                                    <option value="">Select</option>
                                                    @foreach($UnitColor as $_color)
                                                    <option value="{{$_color->m_color_id}}" >{{$_color->color_name}}</option>
                                                    @endforeach
                                                </select>
                                            </div>
                                            <div class="col-md-2">
                                                <label class="form-label" for="basic-default-fullname">Products Stock</label>
                                                <input type  ="number" class="form-control" min="0" id="product_stock" name="product_stock" required="">
                                            </div>
                                            <div class="col-md-2  d-flex align-items-center" style="margin-top: 16px;">
                                                <input id="unit_id" type="hidden" >
                                                <button type="submit" class="btn btn-success mx-2">Save</button>     
                                                <button type="reset" onclick="$(this).addClass('d-none')" class="btn btn-danger">close</button>
                                            </div>
                                    </form>
                                </div>
                                <div class="card-datatable table-responsive mt-3">
                                    <table id="unitlist_table" class="datatables-customers table border-top">
                                        <thead>
                                            <tr>  
                                                <th>#</th>
                                                <th>Size</th>
                                                <th>Material</th>                                                      
                                                <th>Color</th>
                                                <th>Stock</th> 
                                                <th>Action</th>
                                            </tr>
                                        </thead>
                                    </table>
                                </div>
                            </div>

                            <div class="tab-pane fade" id="navs-justified-image" role="tabpanel">
                                <div class="demo-inline-spacing mt-3">
                                    <div class="list-group" id="image-view-content">

                                       

                                    </div>
                                </div>
                            </div>

                            <div class="tab-pane fade " id="navs-justified-keypoint" role="tabpanel">

                                <input type="text"class="form-control" value='{{isset($productkeypoint) ?$productkeypoint:''}}'  id="keypoint"  data-role="tagsinput" />
                                <div class="text-end" ><button type="submit" id="keypointsave" class="btn btn-success">Save</button></div>
                                    
                            </div>
                        </div>
                    </div>
                </div>

            </div>

        </div>

    </div>

</div>
</div>
<!-- / Content -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.repeater/1.2.1/jquery.repeater.js"></script>

<script src="{{ asset('assets/vendor/bootstrap-tagsinput.js') }}" type="text/javascript"></script>
<script>
                                                    let ta;
                                                    var pid = 0;
                                                    $('#keypoint').tagsinput({
                                                        trimValue: true,
                                                        confirmKeys: [13, 44],
                                                        focusClass: 'my-focus-class'
                                                    });
                                                    $('#basic_form').submit(function (e) {

                                                        var form1 = $(this);
                                                        form1.find(':input').each(function () {
                                                            if (!$(this)[0].checkValidity()) {
                                                                $(this).addClass('is-invalid');
                                                            } else {
                                                                $(this).removeClass('is-invalid');
                                                            }
                                                        });
                                                        if (!form1[0].checkValidity()) {
                                                            event.preventDefault();
                                                            event.stopPropagation();
                                                        } else {
                                                            let self = $(this);
                                                            e.preventDefault(); // prevent default submit behavior
                                                            self.prop('disabled', true);
                                                            var data = $(this).serialize() + "&pid=" + $("#project_id").val()+ "&cid=" + $("#category_id").val(); // get form data

                                                            $.ajax({
                                                                url: '{{ route("storebasicdetails") }}',
                                                                type: "POST",
                                                                data: data,
                                                                dataType: 'json',
                                                            }).done(function (res) {
                                                                if (res["error_code"] == 200) {
                                                                    $("#project_id").val(res["product_id"]);
                                                                    $('[data-bs-target="#navs-justified-profile"]').prop('disabled', false).click();
                                                                    $('.basic_detail_alert.bg-label-success').removeClass("d-none");
                                                                    $('.basic_detail_alert.bg-label-danger').addClass("d-none");
                                                                } else {

                                                                }


                                                            }).fail(function () {

                                                            })
                                                        }
                                                    });
                                                    $('#price_form').submit(function (e) {

                                                        var form1 = $(this);
                                                        form1.find(':input').each(function () {
                                                            if (!$(this)[0].checkValidity()) {
                                                                $(this).addClass('is-invalid');
                                                            } else {
                                                                $(this).removeClass('is-invalid');
                                                            }
                                                        });
                                                        if (!form1[0].checkValidity()) {
                                                            event.preventDefault();
                                                            event.stopPropagation();
                                                        } else {
                                                            let self = $(this);
                                                            e.preventDefault(); // prevent default submit behavior
                                                            self.prop('disabled', true);
                                                            var data = $(this).serialize() + "&pid=" + $("#project_id").val(); // get form data

                                                            $.ajax({
                                                                url: '{{ route("pricebasicdetails") }}',
                                                                type: "POST",
                                                                data: data,
                                                                dataType: 'json',
                                                            }).done(function (res) {
                                                                if (res["error_code"] == 200) {
                                                                    $('[data-bs-target="#navs-justified-messages"]').prop('disabled', false).click();
                                                                    $('.price_detail_alert.bg-label-success').removeClass("d-none");
                                                                    ('.price_detail_alert.bg-label-danger').removeClass("d-none");
                                                                    unitList();
                                                                } else {

                                                                }


                                                            }).fail(function () {

                                                            })
                                                        }
                                                    });
                                                    $('#unit_form').submit(function (e) {

                                                        var form1 = $(this);
                                                        form1.find(':input').each(function () {
                                                            if (!$(this)[0].checkValidity()) {
                                                                $(this).addClass('is-invalid');
                                                            } else {
                                                                $(this).removeClass('is-invalid');
                                                            }
                                                        });
                                                        if (!form1[0].checkValidity()) {
                                                            event.preventDefault();
                                                            event.stopPropagation();
                                                        } else {
                                                            let self = $(this);
                                                            e.preventDefault(); // prevent default submit behavior
                                                            self.prop('disabled', true);
                                                            var data = $(this).serialize() + "&pid=" + $("#project_id").val(); // get form data

                                                            $.ajax({
                                                                url: '{{ route("storeUnitdetails") }}',
                                                                type: "POST",
                                                                data: data,
                                                                dataType: 'json',
                                                            }).done(function (res) {
                                                                if (res["error_code"] == 200) {
                                                                    sno = 0;
                                                                    try{
                                                                    ta.ajax.reload();
                                                                }catch(r){}
                                                                    $('[data-bs-target="#navs-justified-image"]').prop('disabled', false);
                                                                    $('.unit_detail_alert.bg-label-success').removeClass("d-none");
                                                                     $('.unit_detail_alert.bg-label-danger').addClass("d-none");
                                                                } else {

                                                                }


                                                            }).fail(function () {

                                                            })
                                                        }
                                                    });
                                                    $(document).ready(function () {
                                                        
                                                        pid = $("#project_id").val();
                                                        unitList();
//                                                         $.ajax({
//                                                                url: '{{ route("deleteProductImages") }}',
//                                                                type: "POST",
//                                                                data: {'pid': $("#project_id").val(),
//                                                                        _token: '{{ csrf_token() }}'                                                                     
//                                                                       },
//                                                                dataType: 'json',
//                                                            }).done(function (res) {
//                                                                if (res["error_code"] == 200) {
//                                                                                                                                        
//                                                                } else {
//                                                                   
//                                                                }
//
//
//                                                            }).fail(function () {
//
//                                                            })
                                                    });
                                                    function unitList() {
                                                        sno = 0;
                                                        ta = $("#unitlist_table").DataTable({
                                                            ajax: {
                                                                url: '{{ route("getUnitList") }}',
                                                                method: 'POST',
                                                                data: {'pid': $("#project_id").val(),
                                                                    _token: '{{ csrf_token() }}'},
                                                            },
                                                            columns: [
                                                                {
                                                                    className: "text-center",
                                                                    'render': function (data, type, row) {
                                                                        return `${++sno}`;
                                                                    }
                                                                },
                                                                {data: "size_name"},
                                                                {data: "material_name"},
                                                                {
                                                                    className: "text-center",
                                                                    'render': function (data, type, row) {
                                                                        return `<span class="color-show" style="background:${row['color_code']}"></span>${row['color_name']}`;
                                                                    }
                                                                },
                                                                {
                                                                    className: "text-center",
                                                                    'render': function (data, type, row) {
                                                                        return `<span class="badge bg-label-success">${row['stock']}</span>`;
                                                                    }
                                                                },
                                                                {
                                                                    className: "text-center",
                                                                    'render': function (data, type, row) {
                                                                        return ` <button type="button" data-id="${row['product_unit_id']}" class=" update_data btn mx-2  btn-icon btn-outline-primary">
                                                                        <span class="tf-icons bx bx-pencil"></span>
                                                                      </button><button type="button"  data-id="${row['product_unit_id']}" class="btn delete  btn-icon btn-outline-danger">
                                                                        <span class="tf-icons bx bxs-trash"></span>
                                                                      </button>`;
                                                                    }
                                                                },
                                                            ],
                                                            language: {
                                                                sLengthMenu: "_MENU_",
                                                                search: "",
                                                                searchPlaceholder: "Search Matrial"
                                                            },
                                                            "lengthChange": false,
                                                            "pageLength": 10,
                                                            "searching": false,
                                                             destroy:true
                                                                

                                                        });
                                                    }

                                                    $(document).on("change", ".product_upload", function () {
//                                                         
                                                        var file = this.files[0];
                                                        if (!file) {

                                                            return;
                                                        }
                                                        var content = $(this).data('content');
                                                        
                                                        var process_bar = $(`.${content} .progress-bar`);
                                                        process_bar.html('0%').css('width', '0%');

                                                        var formData = new FormData();
                                                        formData.append('product_images', file);
                                                        formData.append('_token', '{{ csrf_token() }}');
                                                        formData.append('imageunit', $(this).data('imageunit'));
                                                        formData.append('imagecount', $(this).data('imagecount'));
                                                        formData.append('pid', $("#project_id").val());
                                                        $.ajax({
                                                            url: '{{ route("uploadImages") }}',
                                                            type: 'POST',
                                                            data: formData,
                                                            processData: false,
                                                            contentType: false,
                                                            xhr: function () {
                                                                var xhr = new window.XMLHttpRequest();
                                                                xhr.upload.addEventListener('progress', function (evt) {
                                                                    if (evt.lengthComputable) {
                                                                        var percentComplete = (evt.loaded / evt.total) * 100;
                                                                        process_bar.html(percentComplete.toFixed(2) + '%').width(percentComplete + '%');
                                                                    }
                                                                }, false);
                                                                return xhr;
                                                            },
                                                            success: function (data) {
                                                                    const reader = new FileReader();          
                                                                           reader.onload = function(e) {
                                                                                $(`.${content} img`).attr('src', e.target.result).removeClass('d-none').css('background','#e1eff5');
                                                                              
                                                                              }          
                                                                 reader.readAsDataURL(file);                                                                 
                                                                process_bar.html('0%').css('width', '0%');
                                                                $(`.${content} .image-delete`).removeClass('d-none');
                                                                $('[data-bs-target="#navs-justified-keypoint"]').prop('disabled', false);
                                                                $('.image_detail_alert.bg-label-success').removeClass("d-none");
                                                                $('.image_detail_alert.bg-label-danger').addClass("d-none");
                                                            }
                                                        });
                                                    });
                                                
                                                 var product_url='{{asset('uploads/products')}}';
                                                  $(document).on("click", '[data-bs-target="#navs-justified-image"]', function () { 
                                                     $.ajax({
                                                                url: '{{ route("getProductImage") }}',
                                                                type: "POST",
                                                                data: {'pid': $("#project_id").val(),
                                                                    _token: '{{ csrf_token() }}'},
                                                                dataType: 'json',
                                                            }).done(function (res) {
                                                                if (res["error_code"] == 200) {
                                                                     
                                                                     $("#image-view-content").html('');
                                                                    $.each(res["images"], function(index, image) {
                                                                        var _res = `
                                                  <a class=" flex-column align-items-start">
                                                        <div class="d-flex justify-content-between w-100">
                                                            <h6>${image.color_name} <span class="color-show" style="background:${image.color_code}"></span></h6>                                                
                                                        </div>
                                                        <div class="row" >`;
                                                for(var i =1 ;i<6 ;i++){
                                              _res +=`   <div class="col-md-2 mx-2" >
                                                    <div  class="image-content img-con-${i}-${image.m_color_id}" >
                                                        <span class="${(image['web_image_'+i] !=null )?'':'d-none'} image-delete" data-imageunit="${image.product_image_id}" data-imagecount="${i}"  data-content="img-con-${i}-${image.m_color_id}"><i class='bx bxs-trash'></i></span>
                                                        <input accept=".png, .jpg, .jpeg" data-imageunit="${image.product_image_id}" data-imagecount="${i}"  class="product_upload" type="file" data-content="img-con-${i}-${image.m_color_id}" id="product_upload_${image.m_color_id}_${i}" style="display: none" >
                                                        <img class="${(image['web_image_'+i] !=null )?'':'d-none'}" style="${(image['web_image_'+i] !=null )?'background:#e1eff5':''}" src="${(image['web_image_'+i] !=null )?(product_url+'/'+image['web_image_'+i]):''}">
                                                        <label for="product_upload_${image.m_color_id}_${i}"><i class='bx bx-plus'></i> Add Image </label>
                                                        <div class="progress w-100 ">
                                                            <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">
                                                                0%
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>`;
                                                }
                                               _res +=` </div></a>`;
                                               $("#image-view-content").append( _res );
//                                                                            
});
                                                                } else {
                                                                   $("#image-view-content").html('<h3>No Unit List</h3>')
                                                                }


                                                            }).fail(function () {

                                                            })
                                                 })
                                                 
                                                  $(document).on("click", ".image-delete", function () { 
                                                   var content = $(this).data('content');
                                                   $.ajax({
                                                                url: '{{ route("deleteProductImages") }}',
                                                                type: "POST",
                                                                data: {'pid': $("#project_id").val(),
                                                                        _token: '{{ csrf_token() }}',
                                                                        imageunit : $(this).data('imageunit'),
                                                                        imagecount : $(this).data('imagecount')
                                                                       },
                                                                dataType: 'json',
                                                            }).done(function (res) {
                                                                if (res["error_code"] == 200) {
                                                                    
                                                                    var process_bar = $(`.${content} .progress-bar`);
                                                                    process_bar.html('0%').css('width', '0%');
                                                                    $(`.${content} img`).addClass('d-none');
                                                                    $(`.${content} .image-delete`).addClass('d-none'); 
                                                                   
                                                                } else {
                                                                   
                                                                }


                                                            }).fail(function () {

                                                            })
                                                  
                                                        
                                                         
                                                 })
                                                 
                                                  $(document).on("click", "#keypointsave", function () { 
                                                   
                                                   $.ajax({
                                                                url: '{{ route("saveWordProduct") }}',
                                                                type: "POST",
                                                                data: {'pid': $("#project_id").val(),
                                                                        _token: '{{ csrf_token() }}',
                                                                        keypoint : $("#keypoint").val(),                                                                         
                                                                       },
                                                                dataType: 'json',
                                                            }).done(function (res) {
                                                                if (res["error_code"] == 200) {
                                                                    $('.key_detail_alert.bg-label-success').removeClass("d-none");
                                                                    $('.key_detail_alert.bg-label-danger').addClass("d-none");
                                                                   
                                                                } else {
                                                                   
                                                                }


                                                            }).fail(function () {

                                                            })
                                                  
                                                        
                                                         
                                                 })

</script>


@endsection